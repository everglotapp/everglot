query OutstandingFcmNotifications($notExpiredAt: Datetime!) {
    notificationChannelByName(name: "Firebase Cloud Messaging") {
        notificationsByChannelId(
            orderBy: CREATED_AT_ASC
            filter: {
                and: {
                    sentAt: { isNull: true }
                    or: [
                        { expiresAt: { greaterThan: $notExpiredAt } }
                        { expiresAt: { isNull: true } }
                    ]
                }
            }
        ) {
            nodes {
                id
                recipient {
                    userDevices {
                        nodes {
                            fcmToken
                        }
                    }
                    uuid
                }
                params
                expiresAt
                withheldUntil
                recipientGroup {
                    uuid
                    groupUsers {
                        nodes {
                            user {
                                userDevices {
                                    nodes {
                                        fcmToken
                                    }
                                }
                                uuid
                            }
                        }
                    }
                }
            }
        }
    }
}
